(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-156a2d30"],{"1de2":function(e,t,a){},"225b":function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"iframe-container"},[a("el-row",[e.templateStore.isVisibleNavBar?a("el-card",{staticClass:"box-card"},[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},[a("el-button",{staticClass:"button-nav-bar",attrs:{type:"success",size:"small",plain:""},on:{click:e.saveTemplate}},[e._v("Guardar plantilla")]),a("el-button",{staticClass:"button-nav-bar",attrs:{type:"primary",size:"small",plain:""},on:{click:e.clearTemplate}},[e._v("Limpiar Plantilla")]),a("el-button",{staticClass:"button-nav-bar",attrs:{type:"danger",size:"small",plain:""},on:{click:e.goToIndex}},[e._v("Cancelar")]),a("el-button",{staticClass:"button-nav-bar",attrs:{type:"warning",size:"small",plain:""},on:{click:e.showEditorSettings}},[e._v("Configuración de Editor")]),a("el-submenu",{staticClass:"files-nav-bar",attrs:{index:"1"}},[a("template",{slot:"title"},[e._v("Archivos CSS")]),a("el-menu-item",{attrs:{index:"1-1"}},[e._v("Añadir un archivo CSS")]),a("el-menu-item",{attrs:{index:"1-2"}},[e._v("Añadir un CDN de CSS")])],2),a("el-submenu",{staticClass:"files-nav-bar",attrs:{index:"2"}},[a("template",{slot:"title"},[e._v("Archivos JavaScript")]),a("el-menu-item",{attrs:{index:"2-1"}},[e._v("Añadir un archivo JavaScript")]),a("el-menu-item",{attrs:{index:"2-2"}},[e._v("Añadir un CDN de JavaScript")])],2)],1)],1):e._e()],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.templateStore.isVisibleNavBar?"Cerrar Barra":"Abrir Barra",placement:"right"}},[a("el-button",{staticClass:"test",attrs:{type:"text"},on:{click:e.templateStore.showNavBar}},[e.templateStore.isVisibleNavBar?a("i",{staticClass:"el-icon-top icon-button"}):a("i",{staticClass:"el-icon-bottom icon-button"})])],1),a("el-dialog",{attrs:{title:e.templateStore.isJavascript?"Añade JavaScript":"Añande CSS",visible:e.templateStore.dialogVisible,width:"50%","before-close":e.templateStore.handleClose},on:{"update:visible":function(t){return e.$set(e.templateStore,"dialogVisible",t)}}},[e.templateStore.isJavascript?a("javascript"):a("css"),"3"===e.templateStore.isFile?a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.templateStore.loading,expression:"templateStore.loading"}],attrs:{gutter:10,type:"flex",justify:"center"}},[a("el-col",{attrs:{xs:23,sm:23,md:23,lg:23,xl:23}},[a("h2",[e._v(" Edita el "+e._s(e.templateStore.isJavascript?"JavaScript":"CSS")+" Personalizado ")]),a("div",[a("codemirror",{attrs:{"v-model":e.content,options:e.cmOptions}})],1)])],1):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.templateStore.dialogVisible=!1}}},[e._v("Cancel")]),a("el-button",{attrs:{type:"success"},on:{click:function(t){"3"!==e.templateStore.isFile?e.useAssets():e.onSaveCustomContent()}}},[e._v("Guardar")])],1)],1),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.templateStore.loading,expression:"templateStore.loading"}],attrs:{"element-loading-text":"Cargando...",gutter:10}},[a("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"text item"},[a("iframe",{staticStyle:{height:"650px",width:"100%"},attrs:{id:"viewEditor"}})])])],1)],1)],1)},i=[],l=a("c7eb"),s=a("1da1"),o=a("5530"),c=(a("d3b7"),a("d9e2"),a("ac1f"),a("1276"),a("2f62")),u=a("9692"),d=a("35a4"),p=a("536c"),m=a("fce5"),f=a("f1dc"),v=a("ddd0"),b=a("c6ee"),h=a("8f94"),g=a("2ef0"),C=a.n(g),x=Object(d["a"])(),S=Object(p["a"])(),w=Object(m["a"])(),y=Object(f["a"])(),_={components:{javascript:v["a"],codemirror:h["codemirror"],css:b["a"]},data:function(){return{configStore:x,templateStore:S,cssStore:w,javascriptStore:y,isFile:!0,activeIndex:"1",content:"ds",contentHtml:"",cmOptions:{tabSize:4,mode:S.isJavascript?"javascript":"text/css",theme:"dracula",lineNumbers:!0,line:!0}}},computed:Object(o["a"])({},Object(c["b"])(["token"])),mounted:function(){var e=this;this.$nextTick(Object(s["a"])(Object(l["a"])().mark((function e(){return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=document.getElementById("viewEditor"),this.useAssets();case 2:case"end":return e.stop()}}),e,this)})))),window.addEventListener("message",(function(t){e.contentHtml=t.data}))},created:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return S.isEdit=!0,S.keyName=e.$route.params.keyName,a=C.a.cloneDeep(S.keyName),t.next=5,w.fetchCss(a);case 5:return t.next=7,w.fetchCustomCss(S.keyName);case 7:return t.next=9,y.fetchJavascript(a);case 9:return t.next=11,y.fetchCustomJavascript(S.keyName);case 11:return t.next=13,S.showTemplate(a);case 13:case"end":return t.stop()}}),t)})))()},methods:{handleGetMain:function(){var e=this;this.loading=!0,Object(u["a"])(S.keyName).then((function(t){e.form=t.data})).catch(this.responseCatch).finally((function(){return e.loading=!1}))},onUpdate:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])(e.form,S.keyName).then((function(t){e.$message({showClose:!0,message:"¡Actuliazacion completa!",type:"success"}),e.goListMain()})).catch(e.responseCatch);case 2:case"end":return t.stop()}}),t)})))()},goToIndex:function(){this.$router.push({name:"footer.index"})},useAssets:function(){S.dialogVisible=!1,n.setAttribute("src",x.baseUrl+"manager/editor/footer/"+S.keyName)},getInfoIframe:function(e){var t=this;return Object(s["a"])(Object(l["a"])().mark((function a(){return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,n){var r=document.getElementById("viewEditor").contentWindow;r.postMessage(e,"*"),setTimeout((function(){return void 0!==t.contentHtml||""!==t.contentHtml?a(t.contentHtml):n(new Error("esperando resultado"))}),3e3)})));case 1:case"end":return a.stop()}}),a)})))()},saveTemplate:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getInfoIframe("html#"+e.token);case 2:void 0===e.contentHtml||""===e.contentHtml?e.$message.error("Error al guardar. Intenta de nuevo."):(S.loading=!0,a=C.a.cloneDeep(e.contentHtml),n=C.a.cloneDeep(S.keyName),S.updateContentHtml(a,n).then((function(){e.goToIndex()})).finally((function(){return S.loading=!1})));case 3:case"end":return t.stop()}}),t)})))()},clearTemplate:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return S.loading=!0,t.next=3,e.getInfoIframe("clear");case 3:a=C.a.cloneDeep(e.contentHtml),n=C.a.cloneDeep(S.keyName),S.updateContentHtml(a,n).finally((function(){S.loading=!1,e.useAssets()}));case 6:case"end":return t.stop()}}),t)})))()},showEditorSettings:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getInfoIframe("settings");case 2:case"end":return t.stop()}}),t)})))()},onSaveCustomContent:function(){if(S.isJavascript){var e=C.a.cloneDeep(y.content),t=C.a.cloneDeep(S.keyName);y.updateCustomJavascript(e,t)}else{var a=C.a.cloneDeep(S.keyName);console.log("~ keyName",a)}},handleSelect:function(e,t){S.dialogVisible=!0,"2"===t[0]?(S.isJavascript=!0,S.isFile=e.split("-")[1]):(S.isJavascript=!1,S.isFile=e.split("-")[1])}}},j=_,k=(a("bb8a"),a("2877")),O=Object(k["a"])(j,r,i,!1,null,"6e556716",null);t["default"]=O.exports},5408:function(e,t,a){},7408:function(e,t,a){"use strict";a("5408")},9692:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a("b775");function r(e){return Object(n["a"])({url:"/template/main/"+e,method:"get"})}function i(e,t){return Object(n["a"])({url:"/template/main/"+t,method:"put",data:e})}},bb8a:function(e,t,a){"use strict";a("1de2")},c6ee:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.cssStore.loading,expression:"cssStore.loading"}],attrs:{gutter:10,type:"flex",justify:"center","element-loading-text":"Cargando..."}},[a("el-col",{attrs:{xs:23,sm:23,md:12,lg:12,xl:12}},["1"===e.templateStore.isFile?a("div",[a("label",[e._v("Arrastra tu archivo css para agregarlo a tu plantilla")]),a("br"),a("el-upload",{staticClass:"upload-demo",attrs:{name:"fileCSS",action:"#","show-file-list":!1,"http-request":e.uploadFile,drag:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" Suelta tu archivo aquí o "),a("em",[e._v("haz clic para cargar")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" Solo archivos CSS con un tamaño menor de 10 MB ")])])],1):e._e(),"2"===e.templateStore.isFile?a("div",[a("label",[e._v("Agrega url CDN par agregarla al sitio")]),a("br"),a("br"),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{placeholder:"Url CDN"},model:{value:e.cdnUrl,callback:function(t){e.cdnUrl=t},expression:"cdnUrl"}})],1)],1),a("el-button",{attrs:{type:"success"},on:{click:e.uploadCDN}},[e._v(" Agregar CDN ")])],1):e._e()]),"1"===e.templateStore.isFile||"2"===e.templateStore.isFile?a("el-col",{attrs:{xs:23,sm:23,md:15,lg:17,xl:15}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Archivos cargados en el sitio")])]),a("div",{staticClass:"text item"},[a("div",{staticClass:"custom-tree-container"},[a("div",{staticClass:"block"},[a("el-tree",{attrs:{data:e.cssStore.list,"node-key":"id",props:e.defaultProps,"default-expand-all":"",draggable:"","allow-drop":e.allowDrop},on:{"node-drop":e.handleDrop},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(n.label))]),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.deleteFile(n,r)}}},[e._v(" Eliminar ")])],1)])}}],null,!1,1570934514)}),a("br"),a("div",{attrs:{align:"right"}},[a("el-button",{attrs:{type:"primary",size:"medium",aling:"right"},on:{click:function(t){return e.updateTree()}}},[e._v(" Actualizar ")])],1)],1)])])])],1):e._e()],1)],1)},r=[],i=a("c7eb"),l=a("1da1"),s=(a("b0c0"),a("d3b7"),a("c740"),a("a434"),a("fce5")),o=a("536c"),c=a("bca1"),u=a("2ef0"),d=a.n(u),p=Object(s["a"])(),m=Object(o["a"])(),f={name:"Css",components:{},data:function(){return{cssStore:p,templateStore:m,cdnUrl:"",defaultProps:{label:"name"},content:"",cmOptions:{tabSize:4,mode:"text/css",theme:"dracula",lineNumbers:!0,line:!0}}},created:function(){},mounted:function(){},computed:{codemirror:function(){return this.$refs.editorCss.codemirror}},methods:{uploadCDN:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:m.loading=!0,p.file.name=e.cdnUrl,p.file.pathFile=e.cdnUrl,p.file.type="External",p.file.order=p.list.length+1,a=d.a.cloneDeep(p.file),n=d.a.cloneDeep(m.keyName),p.storeCssFile(a,n).finally((function(){e.cdnUrl="",m.loading=!1}));case 8:case"end":return t.stop()}}),t)})))()},uploadFile:function(e){return Object(l["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:m.loading=!0,a=new FormData,a.append("file",e.file),a.append("fileName",e.file.name),a.append("folder","template"),Object(c["a"])(a).then((function(t){p.file.name=e.file.name,p.file.pathFile=t.data,p.file.type="Internal",p.file.order=p.list.length+1;var a=d.a.cloneDeep(p.file),n=d.a.cloneDeep(m.keyName);p.storeCssFile(a,n)})).catch((function(t){e.onError()})).finally((function(){return m.loading=!1}));case 6:case"end":return t.stop()}}),t)})))()},handleDrop:function(){p.orderFilesCss()},allowDrop:function(e,t,a){if("inner"!==a)return!0},updateTree:function(){var e=d.a.cloneDeep(m.keyName),t=d.a.cloneDeep(p.list);p.updateCssFiles(t,e)},deleteFile:function(e,t){var a=this;this.$confirm("Se borrara el arvhivo de su sitio, ¿Esta seguro?","Cuidado",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"}).then((function(){var a=e.parent,n=a.data.children||a.data,r=n.findIndex((function(e){return e._id===t._id})),i=d.a.cloneDeep(m.keyName),l=d.a.cloneDeep(t._id);p.deleteCssFile(i,l).then((function(e){n.splice(r,1)}))})).catch((function(){a.$message({showClose:!0,type:"info",message:"Se cancelo la operación"})}))}}},v=f,b=(a("7408"),a("2877")),h=Object(b["a"])(v,n,r,!1,null,null,null);t["a"]=h.exports},ddd0:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.javascriptStore.loading,expression:"javascriptStore.loading"}],attrs:{gutter:10,"element-loading-text":"Cargando...",type:"flex",justify:"center"}},[a("el-col",{attrs:{xs:23,sm:23,md:12,lg:12,xl:12}},["1"===e.templateStore.isFile?a("div",[a("label",[e._v("Arrastra tu archivo js para agregarlo al sitio")]),a("br"),a("el-upload",{staticClass:"upload-demo",attrs:{name:"fileJS",action:"#","show-file-list":!1,drag:"","http-request":e.uploadFile}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" Suelta tu archivo aquí o "),a("em",[e._v("haz clic para cargar")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" Solo archivos CSS con un tamaño menor de 10 MB ")])])],1):e._e(),"2"===e.templateStore.isFile?a("div",[a("label",[e._v("Agrega url CDN par agregarla al sitio")]),a("br"),a("br"),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{placeholder:"Url CDN"},model:{value:e.cdnUrl,callback:function(t){e.cdnUrl=t},expression:"cdnUrl"}})],1)],1),a("el-button",{attrs:{type:"success"},on:{click:e.uploadCDN}},[e._v(" Agregar CDN ")])],1):e._e()]),"1"===e.templateStore.isFile||"2"===e.templateStore.isFile?a("el-col",{attrs:{xs:23,sm:23,md:15,lg:17,xl:15}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Archivos cargados en el sitio")])]),a("div",{staticClass:"text item"},[a("div",{staticClass:"custom-tree-container"},[a("div",{staticClass:"block"},[a("el-tree",{attrs:{data:e.javascriptStore.list,"node-key":"id",props:e.defaultProps,"default-expand-all":"",draggable:"","allow-drop":e.allowDrop},on:{"node-drop":e.handleDrop},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(n.label))]),a("span",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.deleteFile(n,r)}}},[e._v(" Eliminar ")])],1)])}}],null,!1,1570934514)}),a("br"),a("div",{attrs:{align:"right"}},[a("el-button",{attrs:{type:"primary",size:"medium",aling:"right"},on:{click:function(t){return e.updateTree()}}},[e._v(" Actualizar ")])],1)],1)])])])],1):e._e()],1)],1)},r=[],i=a("c7eb"),l=a("1da1"),s=(a("b0c0"),a("d3b7"),a("c740"),a("a434"),a("f1dc")),o=a("ac90"),c=a("536c"),u=a("2ef0"),d=a.n(u),p=Object(s["a"])(),m=Object(c["a"])(),f={name:"Javascript",components:{},data:function(){return{loading:!1,cdnUrl:"",javascriptStore:p,templateStore:m,defaultProps:{label:"name"},cmOptions:{tabSize:4,mode:"javascript",theme:"dracula",lineNumbers:!0,line:!0}}},created:function(){},computed:{codemirror:function(){return this.$refs.editorJavascript.codemirror}},mounted:function(){},methods:{uploadCDN:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:m.loading=!0,p.file.name=e.cdnUrl,p.file.pathFile=e.cdnUrl,p.file.type="External",p.file.order=p.list.length+1,a=d.a.cloneDeep(m.keyName),n=d.a.cloneDeep(p.file),p.storeJavascriptFile(n,a).finally((function(){e.cdnUrl="",m.loading=!1}));case 8:case"end":return t.stop()}}),t)})))()},uploadFile:function(e){return Object(l["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:m.loading=!0,a=new FormData,a.append("file",e.file),a.append("fileName",e.file.name),a.append("folder","template"),Object(o["a"])(a).then((function(t){p.file.name=e.file.name,p.file.pathFile=t.data,p.file.type="Internal",p.file.order=p.list.length+1;var a=d.a.cloneDeep(p.file),n=d.a.cloneDeep(m.keyName);p.storeJavascriptFile(a,n)})).catch((function(t){e.onError()})).finally((function(){return m.loading=!1}));case 6:case"end":return t.stop()}}),t)})))()},handleDrop:function(){p.orderFilesJavascript()},allowDrop:function(e,t,a){if("inner"!==a)return!0},updateTree:function(){var e=d.a.cloneDeep(m.keyName),t=d.a.cloneDeep(p.list);p.updateJavascriptFiles(t,e)},deleteFile:function(e,t){var a=this;this.$confirm("Se borrara el arvhivo de su sitio, ¿Esta seguro?","Cuidado",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"}).then((function(){var a=e.parent,n=a.data.children||a.data,r=n.findIndex((function(e){return e._id===t._id})),i=d.a.cloneDeep(m.keyName),l=d.a.cloneDeep(t._id);p.deleteJavascriptFile(i,l).then((function(e){n.splice(r,1)}))})).catch((function(){a.$message({showClose:!0,type:"info",message:"Se cancelo la operación"})}))},saveCustomJavascript:function(){var e=d.a.cloneDeep(m.keyName),t=d.a.cloneDeep(p.content);p.updateCustomJavascript(e,t)}}},v=f,b=a("2877"),h=Object(b["a"])(v,n,r,!1,null,null,null);t["a"]=h.exports}}]);
//# sourceMappingURL=chunk-156a2d30.434bca60.js.map